import{a as e,r as a,f as t,j as l,G as s,i,b as n,h as o,k as r,W as c}from"./index-DMztQwJg.js";import{r as d,a as p}from"./recharts-Du2nWM4a.js";import{a as x,g as m,b}from"./styleHelpers-C-Ol2m0x.js";import{a5 as h,aN as u,V as g,aO as _,aP as f,aQ as w,aR as N,aS as v,aT as k,aU as y}from"./lucide-DOXEVAr0.js";import"./react-CkAx5jlO.js";import"./three-BIQ0MFnl.js";import"./crypto-B1cJ1F4j.js";import"./confetti-3I5x4t_c.js";const z=d.memo(({settings:z,onUpdateSettings:C,onToggleTheme:S,day:$=1,balance:j=59,xp:A=10,checkInStreak:B=1,transactions:T=[],reviews:D=[]})=>{const{theme:V}=e(),W=V.includes("dark"),F=V.startsWith("neomorphic"),U="neomorphic-dark"===V,E=x(F,V,W),O=m(W,F,"main"),J=m(W,F,"sub");d.useState(!1),d.useState(!0),d.useState(!0);const[G,I]=d.useState(null),[M,K]=d.useState("local"),[L,P]=d.useState("webdav"),[R,H]=d.useState(()=>{const e=a();return{url:e.url,username:e.username,password:e.password,basePath:"/人生游戏管理系统"}}),[Q,q]=d.useState({clientId:"",clientSecret:"",redirectUri:"https://localhost"}),[X,Y]=d.useState(""),[Z,ee]=d.useState(!1),[ae,te]=d.useState("");d.useState(!1);const[le,se]=d.useState(!1),[ie]=d.useState(!1),[ne,oe]=d.useState(null),[re,ce]=d.useState(!1),[de,pe]=d.useState([]),[xe,me]=d.useState("");d.useState(z.autoBackupEnabled??!0),d.useState(z.autoBackupInterval||"daily"),d.useState(z.autoBackupTime||"10:00"),d.useState(""),d.useState(""),d.useState(z.customBackupPath||""),d.useState(!0),p.useEffect(()=>{(()=>{const e=localStorage.getItem("localBackups");if(e)try{const a=JSON.parse(e);pe(a)}catch(a){console.error("Failed to parse local backups:",a)}})();const e=e=>{oe(e),ce(!0)};return t.addProgressCallback(e),()=>{t.removeProgressCallback(e)}},[]);const be=(e,a)=>function(e,a,t,l,s){if(t){const e=b("neomorphic-dark"===l);return`${e.bg} ${e.border} ${e.shadow} ${e.hoverShadow} ${e.activeShadow} ${e.transition}`}return s?"bg-zinc-900 border-zinc-800 text-zinc-500 hover:border-zinc-700":"bg-white border-slate-300 text-slate-600 hover:border-slate-200"}(0,0,F,V,W);return l.jsx("div",{className:["h-full flex flex-col overflow-hidden",F?"neomorphic-dark"===V?"bg-[#1e1e2e]":"bg-[#e0e5ec]":W?"bg-zinc-950":"bg-slate-50"].join(" "),children:l.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:l.jsxs("div",{className:"space-y-3 px-2 md:px-4 lg:px-6 max-w-5xl mx-auto",children:[l.jsxs("div",{className:`${E} border p-4 rounded-3xl transition-all duration-300 mt-4`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(h,{size:18,className:"text-purple-500"}),l.jsxs("div",{children:[l.jsx("h3",{className:`font-bold text-sm ${O}`,children:"音效设置"}),l.jsx("p",{className:`text-[9px] ${J}`,children:"控制系统音效音量与位置音效"})]})]}),l.jsx(s,{helpId:"sound",onHelpClick:I,size:14,variant:"ghost"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[z.enableSoundEffects?l.jsx(u,{size:16,className:"text-purple-500"}):l.jsx(g,{size:16,className:"text-zinc-500"}),l.jsx("span",{className:`text-sm ${O}`,children:"启用音效"})]}),l.jsx("button",{onClick:()=>C({enableSoundEffects:!z.enableSoundEffects}),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-all "+(F?"shadow-[inset_2px_2px_4px_rgba(163,177,198,0.6),inset_-2px_-2px_4px_rgba(255,255,255,1)] "+(z.enableSoundEffects?"bg-blue-500":"bg-white"):z.enableSoundEffects?"bg-blue-600":"bg-white"),children:l.jsx("span",{className:`inline-block h-4.5 w-4.5 transform rounded-full transition-transform ${F?"bg-[#e0e5ec] shadow-[4px_4px_8px_rgba(163,177,198,0.6),-4px_-4px_8px_rgba(255,255,255,1)]":"bg-white"} ${z.enableSoundEffects?"translate-x-6":"translate-x-1"}`})})]}),z.enableSoundEffects&&l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:`text-xs ${O}`,children:"音效音量"}),l.jsxs("span",{className:`text-xs font-mono ${J}`,children:[Math.round(100*z.soundEffectVolume),"%"]})]}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:z.soundEffectVolume,onChange:e=>C({soundEffectVolume:parseFloat(e.target.value)}),className:"w-full h-1.5 rounded-full appearance-none cursor-pointer shadow-inner "+(W?"bg-zinc-800":"bg-slate-200"),style:{background:`linear-gradient(to right, #a855f7 ${100*z.soundEffectVolume}%, ${W?"#3f3f46":"#e2e8f0"} ${100*z.soundEffectVolume}%)`}})]}),z.enableSoundEffects&&l.jsxs("div",{className:"mt-3",children:[l.jsx("h4",{className:`font-bold text-xs ${O} mb-2`,children:"按位置分类音效"}),l.jsxs("div",{className:["rounded-lg p-2 h-[250px] overflow-y-auto",F?U?"bg-[#1e1e2e] shadow-[8px_8px_16px_rgba(0,0,0,0.2),-8px_-8px_16px_rgba(30,30,46,0.8)]":"bg-[#e0e5ec] shadow-[8px_8px_16px_rgba(163,177,198,0.6),-8px_-8px_16px_rgba(255,255,255,1)]":W?"bg-zinc-900/50":"bg-slate-50"].join(" "),children:[l.jsx("h5",{className:`text-[9px] font-mono uppercase mb-2 ${J}`,children:"位置列表"}),l.jsx("div",{className:"space-y-2",children:[{id:"taskComplete",name:"日常任务完成",icon:l.jsx(u,{size:14,className:"text-green-500"})},{id:"mainTaskComplete",name:"主线任务完成",icon:l.jsx(u,{size:14,className:"text-blue-500"})},{id:"fateTaskComplete",name:"命运任务完成",icon:l.jsx(u,{size:14,className:"text-yellow-500"})},{id:"subTaskComplete",name:"子任务完成",icon:l.jsx(u,{size:14,className:"text-purple-500"})},{id:"dice",name:"命运骰子音效",icon:l.jsx(u,{size:14,className:"text-emerald-500"})},{id:"taskGiveUp",name:"放弃任务",icon:l.jsx(u,{size:14,className:"text-red-500"})},{id:"achievement",name:"成就解锁",icon:l.jsx(u,{size:14,className:"text-indigo-500"})},{id:"purchase",name:"商品购买成功",icon:l.jsx(u,{size:14,className:"text-orange-500"})},{id:"pomodoroStart",name:"番茄钟开始",icon:l.jsx(u,{size:14,className:"text-cyan-500"})},{id:"pomodoroComplete",name:"番茄钟完成",icon:l.jsx(u,{size:14,className:"text-pink-500"})},{id:"notification",name:"任务提醒",icon:l.jsx(u,{size:14,className:"text-lime-500"})},{id:"checkin",name:"签到成功",icon:l.jsx(u,{size:14,className:"text-amber-500"})}].map(e=>{var a;const t={taskComplete:"taskComplete",mainTaskComplete:"mainTaskComplete",fateTaskComplete:"mainTaskComplete",subTaskComplete:"taskComplete",dice:"dice",taskGiveUp:"taskGiveUp",achievement:"achievement",purchase:"purchase",pomodoroStart:"timer",pomodoroComplete:"timer",notification:"notification",checkin:"checkin"},s=(null==(a=z.soundEffectsByLocation)?void 0:a[e.id])||{enabled:!0,sound:t[e.id]||"taskComplete"},i="default"===s.sound?t[e.id]||"taskComplete":s.sound,n={mute:"",taskComplete:"/audio/sfx/日常任务完成音效.mp3",mainTaskComplete:"/audio/sfx/主线任务完成音效超快音效.mp3",taskGiveUp:"/audio/sfx/任务放弃音效bubblepop-254773.mp3",purchase:"/audio/sfx/商品购买支出音效.mp3",notification:"/audio/sfx/任务弹出通知提醒音效level-up-191997.mp3",achievement:"/audio/sfx/成就解锁音频.mp3",timer:"/audio/sfx/番茄钟开始和结束计时音效servant-bell-ring-2-211683.mp3",checkin:"/audio/sfx/签到成功音效.mp3",dice:"/audio/sfx/投骰子音效.mp3","备用-ding-36029":"/audio/sfx/备用-ding-36029.mp3","备用-ding-sfx-330333":"/audio/sfx/备用-ding-sfx-330333.mp3","备用-ding-small-bell-sfx-233008":"/audio/sfx/备用-ding-small-bell-sfx-233008.mp3","备用-doorbell-329311":"/audio/sfx/备用-doorbell-329311.mp3","备用-hotel-bell-ding-1-174457":"/audio/sfx/备用-hotel-bell-ding-1-174457.mp3","备用3":"/audio/sfx/备用3.mp3","备用音效":"/audio/sfx/备用音效.mp3","备用音效3":"/audio/sfx/备用音效3.mp3","成就解锁音频2":"/audio/sfx/成就解锁音频2.mp3"},o=e=>{if("mute"===e)return;const a=new Audio(n[e]),t=a.src.startsWith("http")?a.src:`/Life-Game-Management-System${a.src}`;a.src=t,a.volume=z.soundEffectVolume,a.play().catch(e=>{})};return l.jsxs("div",{className:["p-2 rounded-lg flex items-center justify-between transition-all cursor-pointer",F?U?"bg-[#1e1e2e] shadow-[8px_8px_16px_rgba(0,0,0,0.2),-8px_-8px_16px_rgba(30,30,46,0.8)] hover:shadow-[10px_10px_20px_rgba(0,0,0,0.3),-10px_-10px_20px_rgba(30,30,46,0.9)] active:shadow-[inset_6px_6px_12px_rgba(0,0,0,0.2),inset_-6px_-6px_12px_rgba(30,30,46,0.8)]":"bg-[#e0e5ec] shadow-[8px_8px_16px_rgba(163,177,198,0.6),-8px_-8px_16px_rgba(255,255,255,1)] hover:shadow-[10px_10px_20px_rgba(163,177,198,0.7),-10px_-10px_20px_rgba(255,255,255,1)] active:shadow-[inset_6px_6px_12px_rgba(163,177,198,0.6),inset_-6px_-6px_12px_rgba(255,255,255,1)]":W?"bg-zinc-900/30 hover:bg-zinc-800/50":"bg-white/50 hover:bg-slate-100"].join(" "),children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[e.icon,l.jsx("span",{className:`text-xs ${O}`,children:e.name})]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsxs("select",{value:i,onChange:a=>{const t={...z.soundEffectsByLocation,[e.id]:{...s,sound:a.target.value}};C({soundEffectsByLocation:t}),o(a.target.value)},className:["w-24 text-[10px] px-2 py-1 rounded-lg border-none outline-none",F?U?"bg-[#1e1e2e] shadow-[inset_4px_4px_8px_rgba(0,0,0,0.2),inset_-4px_-4px_8px_rgba(30,30,46,0.8)]":"bg-[#e0e5ec] shadow-[inset_4px_4px_8px_rgba(163,177,198,0.6),inset_-4px_-4px_8px_rgba(255,255,255,1)]":W?"bg-zinc-800 text-white":"bg-white text-slate-800"].join(" "),children:[l.jsx("option",{value:"mute",children:"静音"}),l.jsx("option",{value:"taskComplete",children:"日常任务完成"}),l.jsx("option",{value:"mainTaskComplete",children:"主线任务完成"}),l.jsx("option",{value:"taskGiveUp",children:"任务放弃"}),l.jsx("option",{value:"purchase",children:"商品购买"}),l.jsx("option",{value:"notification",children:"任务通知"}),l.jsx("option",{value:"achievement",children:"成就解锁"}),l.jsx("option",{value:"timer",children:"番茄钟音效"}),l.jsx("option",{value:"checkin",children:"签到成功"}),l.jsx("option",{value:"dice",children:"投骰子"}),l.jsx("option",{value:"备用-ding-36029",children:"备用-提示音1"}),l.jsx("option",{value:"备用-ding-sfx-330333",children:"备用-提示音2"}),l.jsx("option",{value:"备用-ding-small-bell-sfx-233008",children:"备用-提示音3"}),l.jsx("option",{value:"备用-doorbell-329311",children:"备用-门铃"}),l.jsx("option",{value:"备用-hotel-bell-ding-1-174457",children:"备用-酒店铃声"}),l.jsx("option",{value:"备用3",children:"备用3"}),l.jsx("option",{value:"备用音效",children:"备用音效"}),l.jsx("option",{value:"备用音效3",children:"备用音效3"}),l.jsx("option",{value:"成就解锁音频2",children:"成就解锁2"})]}),l.jsx("button",{onClick:()=>o(i),className:["p-1 rounded-full transition-all",F?U?"bg-[#1e1e2e] shadow-[5px_5px_10px_rgba(0,0,0,0.2),-5px_-5px_10px_rgba(30,30,46,0.8)] hover:shadow-[3px_3px_6px_rgba(0,0,0,0.15),-3px_-3px_6px_rgba(30,30,46,0.9)]":"bg-[#e0e5ec] shadow-[5px_5px_10px_rgba(163,177,198,0.6),-5px_-5px_10px_rgba(255,255,255,1)] hover:shadow-[3px_3px_6px_rgba(163,177,198,0.5),-3px_-3px_6px_rgba(255,255,255,1)]":W?"bg-purple-900/30 text-purple-400 hover:bg-purple-800/50":"bg-purple-100 text-purple-700 hover:bg-purple-200"].join(" "),title:"试听",children:l.jsx(u,{size:12})})]}),l.jsx("button",{onClick:()=>{const a={...z.soundEffectsByLocation,[e.id]:{...s,enabled:!s.enabled}};C({soundEffectsByLocation:a})},className:["relative inline-flex h-6 w-11 items-center rounded-full transition-all",F?(U?"shadow-[inset_2px_2px_4px_rgba(0,0,0,0.2),inset_-2px_-2px_4px_rgba(30,30,46,0.8)]":"shadow-[inset_2px_2px_4px_rgba(163,177,198,0.6),inset_-2px_-2px_4px_rgba(255,255,255,1)]")+" "+(s.enabled?"bg-blue-500":U?"bg-[#1e1e2e]":"bg-white"):s.enabled?"bg-blue-600":"bg-white"].join(" "),children:l.jsx("span",{className:["inline-block h-4.5 w-4.5 transform rounded-full transition-transform",F?U?"bg-[#1e1e2e] shadow-[4px_4px_8px_rgba(0,0,0,0.2),-4px_-4px_8px_rgba(30,30,46,0.8)]":"bg-[#e0e5ec] shadow-[4px_4px_8px_rgba(163,177,198,0.6),-4px_-4px_8px_rgba(255,255,255,1)]":"bg-white",s.enabled?"translate-x-6":"translate-x-1"].join(" ")})})]})]},e.id)})})]})]})]})]}),l.jsxs("div",{className:[E,"border p-4 rounded-3xl transition-all duration-300 mt-4"].join(" "),children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(_,{size:18,className:"text-green-500"}),l.jsxs("div",{children:[l.jsx("h3",{className:["font-bold text-sm",O].join(" "),children:"数据管理"}),l.jsx("p",{className:["text-[9px]",J].join(" "),children:"备份与恢复您的数据"})]})]}),l.jsx(s,{helpId:"data",onHelpClick:I,size:14,variant:"ghost"})]}),l.jsxs("div",{className:"flex gap-2 mb-3",children:[l.jsx("button",{onClick:()=>K("local"),className:["flex-1 px-3 py-1.5 rounded-full text-xs font-bold transition-all","local"===M?"bg-blue-500 text-white":be()].join(" "),children:"本地备份"}),l.jsx("button",{onClick:()=>K("cloud"),className:["flex-1 px-3 py-1.5 rounded-full text-xs font-bold transition-all","cloud"===M?"bg-blue-500 text-white":be()].join(" "),children:"云端备份"})]}),"local"===M&&l.jsxs("div",{className:"space-y-2",children:[l.jsxs("button",{onClick:()=>{me("正在创建本地备份...");const e=Date.now().toString(),a=`人生游戏备份_${(new Date).toLocaleString("zh-CN").replace(/[\/:\.]/g,"-")}.json`,t={id:e,name:a,date:(new Date).toLocaleString("zh-CN"),size:"0 KB",status:"in_progress",type:"manual"},l=[...de,t];pe(l),localStorage.setItem("localBackups",JSON.stringify(l));try{const s={settings:z,projects:JSON.parse(localStorage.getItem("projects")||"[]"),habits:JSON.parse(localStorage.getItem("habits")||"[]"),characters:JSON.parse(localStorage.getItem("characters")||"[]"),achievements:JSON.parse(localStorage.getItem("achievements")||"[]"),timestamp:(new Date).toISOString()},i=JSON.stringify(s,null,2),n={...t,size:(new Blob([i]).size/1024).toFixed(2)+" KB",status:"success"},o=l.map(a=>a.id===e?n:a);pe(o),localStorage.setItem("localBackups",JSON.stringify(o));const r=new Blob([i],{type:"application/json"}),c=URL.createObjectURL(r),d=document.createElement("a");d.href=c,d.download=a,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c),me("本地备份创建成功！"),setTimeout(()=>me(""),3e3)}catch(s){console.error("Failed to create local backup:",s);const a={...t,status:"failed"},i=l.map(t=>t.id===e?a:t);pe(i),localStorage.setItem("localBackups",JSON.stringify(i)),me("本地备份创建失败："+s.message)}},className:[be(),"w-full px-3 py-1.5 rounded-full text-xs font-bold transition-all"].join(" "),children:[l.jsx(f,{size:14,className:"inline-block mr-1"}),"创建本地备份"]}),l.jsx("input",{type:"file",accept:".json",onChange:e=>{var a;const t=null==(a=e.target.files)?void 0:a[0];if(t){me("正在解析备份文件...");const e=new FileReader;e.onload=e=>{var a;try{if(!JSON.parse(null==(a=e.target)?void 0:a.result).settings)throw new Error("无效的备份文件格式");me("备份文件解析成功！")}catch(t){console.error("Failed to parse backup file:",t),me("备份文件解析失败："+t.message)}finally{setTimeout(()=>me(""),3e3)}},e.readAsText(t)}},className:"hidden",id:"backup-file-input"}),l.jsxs("label",{htmlFor:"backup-file-input",className:[be(),"w-full px-3 py-1.5 rounded-full text-xs font-bold transition-all cursor-pointer block text-center"].join(" "),children:[l.jsx(w,{size:14,className:"inline-block mr-1"}),"从本地恢复"]}),xe&&l.jsx("p",{className:["text-xs text-center",J].join(" "),children:xe})]}),"cloud"===M&&l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:["text-xs font-bold",O].join(" "),children:"云服务提供商"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>P("webdav"),className:["flex-1 px-3 py-1.5 rounded-full text-xs font-bold transition-all","webdav"===L?"bg-blue-500 text-white":be()].join(" "),children:"WebDAV"}),l.jsx("button",{onClick:()=>P("baidu"),className:["flex-1 px-3 py-1.5 rounded-full text-xs font-bold transition-all","baidu"===L?"bg-blue-500 text-white":be()].join(" "),children:"百度网盘"})]})]}),"webdav"===L&&l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:["text-xs font-bold",O].join(" "),children:"WebDAV服务器地址"}),l.jsx("input",{type:"text",value:R.url,onChange:e=>H({...R,url:e.target.value}),placeholder:"https://dav.jianguoyun.com/dav/",className:["w-full px-2 py-1 rounded text-xs",F?U?"bg-[#1e1e2e] shadow-[inset_4px_4px_8px_rgba(0,0,0,0.4),inset_-4px_-4px_8px_rgba(30,30,46,0.8)] text-zinc-200":"bg-[#e0e5ec] shadow-[inset_4px_4px_8px_rgba(163,177,198,0.6),inset_-4px_-4px_8px_rgba(255,255,255,1)] text-zinc-800":W?"bg-zinc-900 border border-zinc-800 text-zinc-200":"bg-white border border-slate-300 text-zinc-800"].join(" ")})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:["text-xs font-bold",O].join(" "),children:"用户名"}),l.jsx("input",{type:"text",value:R.username,onChange:e=>H({...R,username:e.target.value}),className:["w-full px-2 py-1 rounded text-xs",F?U?"bg-[#1e1e2e] shadow-[inset_4px_4px_8px_rgba(0,0,0,0.4),inset_-4px_-4px_8px_rgba(30,30,46,0.8)] text-zinc-200":"bg-[#e0e5ec] shadow-[inset_4px_4px_8px_rgba(163,177,198,0.6),inset_-4px_-4px_8px_rgba(255,255,255,1)] text-zinc-800":W?"bg-zinc-900 border border-zinc-800 text-zinc-200":"bg-white border border-slate-300 text-zinc-800"].join(" ")})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:["text-xs font-bold",O].join(" "),children:"密码"}),l.jsx("input",{type:"password",value:R.password,onChange:e=>H({...R,password:e.target.value}),className:["w-full px-2 py-1 rounded text-xs",F?U?"bg-[#1e1e2e] shadow-[inset_4px_4px_8px_rgba(0,0,0,0.4),inset_-4px_-4px_8px_rgba(30,30,46,0.8)] text-zinc-200":"bg-[#e0e5ec] shadow-[inset_4px_4px_8px_rgba(163,177,198,0.6),inset_-4px_-4px_8px_rgba(255,255,255,1)] text-zinc-800":W?"bg-zinc-900 border border-zinc-800 text-zinc-200":"bg-white border border-slate-300 text-zinc-800"].join(" ")})]}),l.jsxs("button",{onClick:async()=>{try{r(R),te("配置已保存！正在尝试连接..."),await t.initialize(!0),te("配置已保存并初始化成功！")}catch(e){console.error("Failed to update WebDAV config:",e),te("保存失败："+e.message)}finally{setTimeout(()=>te(""),3e3)}},className:[be(),"w-full px-3 py-1.5 rounded-full text-xs font-bold transition-all"].join(" "),children:[l.jsx(N,{size:14,className:"inline-block mr-1"}),"保存WebDAV配置"]}),l.jsxs("button",{onClick:async()=>{te("正在保存配置并准备备份..."),se(!0);try{if(!R.url||!R.username||!R.password)throw new Error("WebDAV配置不完整，请检查服务器地址、用户名和密码");r(R),await t.initialize(!0),await t.createCloudBackup(),te("WebDAV备份成功！")}catch(e){console.error("Failed to backup to WebDAV:",e);const a=e;let t="WebDAV备份失败：";a.message.includes("WebDAV备份未初始化")?t+="备份管理器未初始化，请稍后重试":a.message.includes("network")||a.message.includes("fetch")?t+="网络连接问题，请检查服务器地址和网络连接":a.message.includes("401")?t+="认证失败，请检查用户名和密码":a.message.includes("403")?t+="权限不足，请检查账户权限":a.message.includes("404")?t+="指定路径不存在，请检查服务器地址和路径":t+=a.message,te(t)}finally{se(!1),setTimeout(()=>te(""),3e3)}},disabled:le,className:[be(),"w-full px-3 py-1.5 rounded-full text-xs font-bold transition-all"].join(" "),children:[l.jsx(v,{size:14,className:"inline-block mr-1"}),le?"备份中...":"备份到WebDAV"]}),l.jsxs("button",{onClick:async()=>{te("正在保存配置并准备恢复...");try{if(!R.url||!R.username||!R.password)throw new Error("WebDAV配置不完整，请检查服务器地址、用户名和密码");r(R),await t.initialize(!0);const e=new c(R),a=`${R.basePath||""}/人生游戏备份_${(new Date).toISOString().split("T")[0]}.json`,l=await e.downloadFile(a);if(!JSON.parse(l).settings)throw new Error("无效的备份文件格式");te("WebDAV恢复成功！")}catch(e){console.error("Failed to restore from WebDAV:",e),te("WebDAV恢复失败："+e.message)}finally{setTimeout(()=>te(""),3e3)}},disabled:ie,className:[be(),"w-full px-3 py-1.5 rounded-full text-xs font-bold transition-all"].join(" "),children:[l.jsx(f,{size:14,className:"inline-block mr-1"}),ie?"恢复中...":"从WebDAV恢复"]}),ae&&l.jsx("p",{className:["text-xs text-center",J].join(" "),children:ae})]}),"baidu"===L&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:["text-xs",J].join(" "),children:"请输入您的百度网盘开放平台API凭证，获取方式：百度网盘开放平台创建应用获取AppKey和SecretKey"}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:["text-xs font-bold",O].join(" "),children:"AppKey (Client ID)"}),l.jsx("input",{type:"text",value:Q.clientId,onChange:e=>q({...Q,clientId:e.target.value}),placeholder:"请输入百度网盘AppKey",className:["w-full px-2 py-1 rounded text-xs",F?U?"bg-[#1e1e2e] shadow-[inset_4px_4px_8px_rgba(0,0,0,0.4),inset_-4px_-4px_8px_rgba(30,30,46,0.8)] text-zinc-200":"bg-[#e0e5ec] shadow-[inset_4px_4px_8px_rgba(163,177,198,0.6),inset_-4px_-4px_8px_rgba(255,255,255,1)] text-zinc-800":W?"bg-zinc-900 border border-zinc-800 text-zinc-200":"bg-white border border-slate-300 text-zinc-800"].join(" ")})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:["text-xs font-bold",O].join(" "),children:"SecretKey (Client Secret)"}),l.jsx("input",{type:"password",value:Q.clientSecret,onChange:e=>q({...Q,clientSecret:e.target.value}),placeholder:"请输入百度网盘SecretKey",className:["w-full px-2 py-1 rounded text-xs",F?U?"bg-[#1e1e2e] shadow-[inset_4px_4px_8px_rgba(0,0,0,0.4),inset_-4px_-4px_8px_rgba(30,30,46,0.8)] text-zinc-200":"bg-[#e0e5ec] shadow-[inset_4px_4px_8px_rgba(163,177,198,0.6),inset_-4px_-4px_8px_rgba(255,255,255,1)] text-zinc-800":W?"bg-zinc-900 border border-zinc-800 text-zinc-200":"bg-white border border-slate-300 text-zinc-800"].join(" ")})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:["text-xs font-bold",O].join(" "),children:"Redirect URI"}),l.jsx("input",{type:"text",value:Q.redirectUri,onChange:e=>q({...Q,redirectUri:e.target.value}),placeholder:"https://localhost",className:["w-full px-2 py-1 rounded text-xs",F?U?"bg-[#1e1e2e] shadow-[inset_4px_4px_8px_rgba(0,0,0,0.4),inset_-4px_-4px_8px_rgba(30,30,46,0.8)] text-zinc-200":"bg-[#e0e5ec] shadow-[inset_4px_4px_8px_rgba(163,177,198,0.6),inset_-4px_-4px_8px_rgba(255,255,255,1)] text-zinc-800":W?"bg-zinc-900 border border-zinc-800 text-zinc-200":"bg-white border border-slate-300 text-zinc-800"].join(" ")})]}),l.jsxs("button",{onClick:async()=>{Y("正在保存百度网盘配置...");try{await t.updateConfig({baiduNetdiskEnabled:!0,cloudBackupProvider:"baidu",baiduNetdiskConfig:Q}),Y("百度网盘配置保存成功！")}catch(e){console.error("Failed to save Baidu Netdisk config:",e),Y("百度网盘配置保存失败："+e.message)}finally{setTimeout(()=>Y(""),3e3)}},className:[be(),"w-full px-3 py-1.5 rounded-full text-xs font-bold transition-all"].join(" "),children:[l.jsx(N,{size:14,className:"inline-block mr-1"}),"保存百度网盘配置"]}),l.jsxs("button",{onClick:async()=>{Y("正在跳转到百度网盘授权页面...");try{await t.updateConfig({baiduNetdiskEnabled:!0,cloudBackupProvider:"baidu",baiduNetdiskConfig:Q}),await t.authBaiduNetdisk(),Y("百度网盘授权成功！"),ee(!0)}catch(e){console.error("Failed to auth Baidu Netdisk:",e),Y("百度网盘授权失败："+e.message)}finally{setTimeout(()=>Y(""),3e3)}},className:[be(),"w-full px-3 py-1.5 rounded-full text-xs font-bold transition-all"].join(" "),children:[l.jsx(v,{size:14,className:"inline-block mr-1"}),"授权百度网盘"]}),l.jsxs("button",{onClick:async()=>{Y("正在备份到百度网盘...");try{await t.updateConfig({baiduNetdiskEnabled:!0,cloudBackupProvider:"baidu",baiduNetdiskConfig:Q}),await t.createCloudBackup(),Y("百度网盘备份成功！")}catch(e){console.error("Failed to backup to Baidu Netdisk:",e),Y("百度网盘备份失败："+e.message)}finally{setTimeout(()=>Y(""),3e3)}},className:[be(),"w-full px-3 py-1.5 rounded-full text-xs font-bold transition-all"].join(" "),children:[l.jsx(v,{size:14,className:"inline-block mr-1"}),"备份到百度网盘"]}),l.jsxs("button",{onClick:async()=>{Y("正在从百度网盘恢复...");try{await t.updateConfig({baiduNetdiskEnabled:!0,cloudBackupProvider:"baidu",baiduNetdiskConfig:Q}),await t.restoreFromCloudBackup(),Y("百度网盘恢复成功！")}catch(e){console.error("Failed to restore from Baidu Netdisk:",e),Y("百度网盘恢复失败："+e.message)}finally{setTimeout(()=>Y(""),3e3)}},className:[be(),"w-full px-3 py-1.5 rounded-full text-xs font-bold transition-all"].join(" "),children:[l.jsx(f,{size:14,className:"inline-block mr-1"}),"从百度网盘恢复"]}),X&&l.jsx("p",{className:["text-xs text-center",J].join(" "),children:X})]})]})]}),l.jsxs("div",{className:`${E} border p-4 rounded-3xl transition-all duration-300 mt-4`,children:[l.jsx("div",{className:"flex items-center justify-between mb-1",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(k,{size:18,className:"text-blue-500"}),l.jsx("div",{children:l.jsx("h3",{className:`font-bold text-sm ${O}`,children:"关于"})})]})}),l.jsx("div",{className:"text-xs space-y-3 pt-2",children:l.jsxs("div",{className:"grid grid-cols-[max-content_1fr] gap-x-2 gap-y-2 items-start",children:[l.jsxs("div",{className:"flex items-center gap-1 pt-0.5",children:[l.jsx(y,{size:14,className:"text-blue-500"}),l.jsx("span",{className:`font-bold text-sm ${O} whitespace-nowrap`,children:"最新版本："})]}),l.jsxs("span",{className:`${J} break-words text-sm`,children:["v",i]}),l.jsxs("div",{className:"flex items-center gap-1 pt-0.5",children:[l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",className:"text-blue-500",children:[l.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),l.jsx("span",{className:`font-bold text-sm ${O} whitespace-nowrap`,children:"开发者："})]}),l.jsx("span",{className:`${J} break-words text-sm`,children:"大胆走夜路"}),l.jsxs("div",{className:"flex items-center gap-1 pt-0.5",children:[l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",className:"text-blue-500",children:l.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),l.jsx("span",{className:`font-bold text-sm ${O} whitespace-nowrap`,children:"联系微信："})]}),l.jsx("span",{className:`${J} break-words text-sm`,children:"zwmrpg"}),l.jsxs("div",{className:"flex items-center gap-1 pt-0.5",children:[l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",className:"text-blue-500",children:[l.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),l.jsx("polyline",{points:"14 2 14 8 20 8"}),l.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),l.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),l.jsx("polyline",{points:"10 9 9 9 8 9"})]}),l.jsx("span",{className:`font-bold text-sm ${O} whitespace-nowrap`,children:"项目介绍："})]}),l.jsx("span",{className:`${J} leading-relaxed text-sm break-words w-full`,children:"人生游戏管理系统是一个综合性的个人成长管理工具，集成了任务管理、习惯养成、专注计时、成就系统等功能，旨在帮助用户更好地规划和追踪个人发展。"}),l.jsxs("div",{className:"flex items-center gap-1 pt-0.5",children:[l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",className:"text-blue-500",children:l.jsx("path",{d:"M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"})}),l.jsx("span",{className:`font-bold text-sm ${O} whitespace-nowrap`,children:"开源地址："})]}),l.jsx("a",{href:"https://github.com/zwmopen/Life-Game-Management-System",target:"_blank",rel:"noopener noreferrer",className:`${J} leading-relaxed text-sm w-full break-all hover:underline hover:text-blue-500 transition-colors`,children:"https://github.com/zwmopen/Life-Game-Management-System"})]})})]}),l.jsx(n,{activeHelp:G,helpContent:o,onClose:()=>I(null),cardBg:E,textMain:O,textSub:J,config:z.guideCardConfig||{fontSize:"medium",borderRadius:"medium",shadowIntensity:"medium",showUnderlyingPrinciple:!0}})]})})})});z.displayName="Settings";export{z as default};//# sourceMappingURL=Settings-BMbYVg8e.js.map
