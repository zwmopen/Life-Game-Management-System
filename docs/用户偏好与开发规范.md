# 用户偏好与开发规范

生成日期：2026-01-12

---

## 1. 用户工作流程偏好

### 1.1 智能体自主工作模式
- **核心原则**：AI应主动完成整个工作闭环，不等待进一步指令
- **工作流程**：发现问题 → 自动检查错误日志 → 提出修复方案 → 执行修复 → 验证修复 → 交付成果
- **用户期望**：当代码出错时，AI能智能体自动主动检查错误日志并提出修复方案，而非等待进一步指令

### 1.2 界面验证要求
- 修复后必须打开预览验证效果
- 逐个点击所有功能模块测试是否有问题
- 挨个检查，有问题的修复
- 修复后再检查，直到没有问题为止
- **全权委托原则**：用户希望AI直接打开预览，不需要用户手动点击预览按钮

### 1.3 问题修复标准
- 完成标志：明确告知"成功了，能打开了，没错误了"
- 避免重复修复：如果修复了很多次仍有问题，需要从架构层面思考根本原因
- 主动识别架构问题：当单个模块过大或问题频发时，主动提出重构建议

---

## 2. 项目文件组织规范

### 2.1 文档管理
- **集中存放原则**：所有项目文档必须放在 `docs/` 目录下
- **命名规范**：文档文件名需使用中文命名，或采用先中文后英文的格式（如：`音频管理库使用说明.md`）
- **文档完整性**：当主文档（如README.md）存在冲突时，转向docs专用目录获取信息

### 2.2 关于模块布局
- 采用整体式布局，避免拆分为多个独立小模块
- 所有文本内容应统一排版，保持语义连贯性
- 版本与版本号、作者与作者名之间不留多余空格
- '联系微信'等标签应与内容同行显示，确保信息区块完整性

---

## 3. 项目主题与UI规范

### 3.1 拟态深色主题标准
- **标准背景色**：`#1e1e2e`（不是#2a2d36）
- **颜色一致性要求**：需要全局搜索并统一所有拟态深色模式的背景色
- **检查范围**：包括所有组件、配置文件、CSS样式

### 3.2 深色模式适配规范
- **背景层级**：主背景、卡片背景及所有嵌套容器在深色模式下必须应用深色主题
- **禁止白色残留**：不允许在深色模式下出现白色背景残留
- **文字对比度**：所有文本元素（特别是按钮文字）在深色背景下需保证足够对比度
- **全面覆盖**：包括荣誉殿堂、思维中心、作战中心等所有界面

### 3.3 主题切换配置
- **默认主题**：拟态浅色
- **切换顺序**：拟态浅色 → 拟态深色 → 普通浅色 → 普通深色（按此循环）

### 3.4 UI设计规范

#### 帮助按钮规范
- **尺寸标准**：全局小问号图标使用14px尺寸（`size={14}`）
- **样式规范**：
  - 使用`transition-colors`实现颜色过渡效果
  - 外层容器使用`hover:scale-[1.1]`实现缩放效果
  - 配合`transition-all duration-300`实现平滑过渡

#### 拟态风格按钮
- **设计风格**：Neomorphism（拟态设计）
- **SVG图标**：优先使用SVG图标而非图片
- **一致性要求**：所有模块按钮保持统一的拟态风格

#### 深色模式文本可读性
- 确保在深色背景下文本颜色有足够对比度
- 特别关注按钮文字、标签文字的可见性
- 避免低对比度导致的阅读困难

---

## 4. 前端开发规范

### 4.1 组件开发规范
- **代码行数限制**：单个组件不超过500行
- **单一职责原则**：每个组件只负责一个功能模块
- **组件复用原则**：优先使用组件复用和模块继承
- **逻辑与UI分离**：使用自定义Hook管理复杂逻辑

### 4.2 代码结构要求
- **避免过度嵌套**：最多3层嵌套
- **TypeScript严格模式**：使用TypeScript严格类型检查
- **避免any类型**：保持类型安全

### 4.3 HTML规范
- **禁止按钮嵌套**：button元素不能嵌套（会导致Hydration错误）
- **正确的事件处理**：直接将onClick传递给自定义组件，而不是包裹额外的button

### 4.4 UI样式管理
- **音频列表排序**：按播放次数降序排列
- **Select样式**：深色模式下select组件需要特殊样式适配
- **待完成任务排序**：优先显示高优先级任务

---

## 5. 响应式设计规范

### 5.1 自适应布局
- 使用Tailwind的响应式类实现多端适配
- 断点标准：`sm` `md` `lg` `xl` `2xl`
- 优先考虑移动端体验

### 5.2 3D预览优化
- UI模块需下移避让3D预览区域
- 避免UI元素遮挡3D场景
- 确保3D模型在全屏模式下清晰可见

---

## 6. 专注模式配置

### 6.1 统计面板行为
- 专注模式下统计面板合并与隐藏
- 非专注状态下显示完整统计信息

### 6.2 视觉效果
- **移除悬停效果**：特定场景下禁用hover视觉反馈
- **背景色配置**：根据模式动态调整背景色
- **缩放效果**：适当的UI元素缩放动画

### 6.3 UI组件显示逻辑
- focusRing、preset-btn等组件根据专注状态动态显示/隐藏
- 确保专注模式下界面简洁，减少干扰

---

## 7. 性能优化规范

### 7.1 渲染优化
- 使用React.memo防止不必要的重渲染
- 使用useCallback缓存事件处理函数
- 使用useMemo缓存计算结果

### 7.2 3D场景优化
- 实现LOD（Level of Detail）系统
- 对象池化（Object Pooling）
- 远距离物体不渲染或使用低精度模型

### 7.3 大列表优化
- 使用虚拟滚动（react-window）
- 图片懒加载
- 骨架屏占位

---

## 8. 项目启动配置

### 8.1 package.json检查
- **启动前验证**：检查package.json中的dev脚本配置
- **端口配置**：确保端口未被占用
- **依赖完整性**：确保所有依赖已正确安装

### 8.2 启动命令
```bash
npm run dev       # 开发模式
npm run build     # 生产构建
npm run preview   # 预览生产版本
npm start         # 完整启动（WebDAV + Vite）
```

---

## 9. 部署配置规范

### 9.1 多平台部署支持
- **Vercel**：参考vercel.json配置
- **Netlify**：支持静态部署
- **GitHub Pages**：支持GitHub Pages部署

### 9.2 构建优化
- 代码分割和动态导入
- 减少打包体积
- 优化首屏加载时间

---

## 10. 技术栈与工具

### 10.1 核心技术
- **前端框架**：React 19.2.3 + TypeScript ~5.8.2
- **构建工具**：Vite 6.2.0
- **3D引擎**：Three.js 0.182.0
- **图表库**：Recharts 3.6.0
- **样式方案**：Tailwind CSS
- **图标库**：lucide-react 0.561.0

### 10.2 推荐工具
- **className管理**：clsx
- **状态管理**：Zustand（可选）
- **虚拟滚动**：react-window
- **动画库**：framer-motion

---

## 11. 错误处理规范

### 11.1 错误边界
- 全局错误边界捕获
- 友好的错误提示
- 错误日志记录

### 11.2 数据验证
- 商品数据格式验证
- null值处理
- 边界条件检查

---

## 12. 代码审查清单

### 12.1 组件审查
- [ ] 组件是否过大（>500行）？
- [ ] 是否存在重复代码？
- [ ] 是否遵循单一职责原则？
- [ ] 是否有性能问题？

### 12.2 类型安全
- [ ] 是否避免使用any？
- [ ] 类型定义是否完整？
- [ ] 是否启用严格模式？

### 12.3 用户体验
- [ ] 响应式设计是否完善？
- [ ] 加载状态是否有反馈？
- [ ] 错误处理是否友好？
- [ ] 深色模式是否适配？

---

## 结语

本文档记录了用户对"人生游戏管理系统"项目的所有偏好、规范和要求。开发过程中应严格遵循这些规范，确保代码质量和用户体验的一致性。

**重要提醒**：
- 主动工作，不等待指令
- 全面测试，确保质量
- 从架构层面思考问题
- 保持代码简洁可维护
